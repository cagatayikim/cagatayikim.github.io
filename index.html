<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>AR</title>

    <style>
    body {
        overflow: hidden;
        margin: 0px;
    }
    </style>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/annyang/2.6.1/annyang.min.js"></script>
</head>
<body>

        <div id="cmds" style="z-index: 100;position: fixed;">sa</div>
        <div id="divv" style="z-index: 100;position: fixed;width: 100%;height: 100%;"></div>
	
<device type="media" onchange="update(this.data)"></device>
<video autoplay></video>
<script>
const videoElement = document.querySelector('video');
const audioSelect = document.querySelector('select#audioSource');
const videoSelect = document.querySelector('select#videoSource');

navigator.mediaDevices.enumerateDevices()
  .then(gotDevices).then(getStream).catch(handleError);

audioSelect.onchange = getStream;
videoSelect.onchange = getStream;

function gotDevices(deviceInfos) {
  for (let i = 0; i !== deviceInfos.length; ++i) {
    const deviceInfo = deviceInfos[i];
    const option = document.createElement('option');
    option.value = deviceInfo.deviceId;
    if (deviceInfo.kind === 'audioinput') {
      option.text = deviceInfo.label ||
        'microphone ' + (audioSelect.length + 1);
      audioSelect.appendChild(option);
    } else if (deviceInfo.kind === 'videoinput') {
      option.text = deviceInfo.label || 'camera ' +
        (videoSelect.length + 1);
      videoSelect.appendChild(option);
    } else {
      console.log('Found another kind of device: ', deviceInfo);
    }
  }
}

function getStream() {
  if (window.stream) {
    window.stream.getTracks().forEach(function(track) {
      track.stop();
    });
  }

  const constraints = {
    audio: {
      deviceId: {exact: audioSelect.value}
    },
    video: {
      deviceId: {exact: videoSelect.value}
    }
  };

  navigator.mediaDevices.getUserMedia(constraints).
    then(gotStream).catch(handleError);
}

function gotStream(stream) {
  window.stream = stream; // make stream available to console
  videoElement.srcObject = stream;
}

function handleError(error) {
  console.error('Error: ', error);
}
</script>

    <script>
    annyang.setLanguage('tr-TR');

var os = true;

        if (annyang) {
          // Let's define our first command. First the text we expect, and then the function it should call
          var commands = {
            'işletim sistemini aç': function() {
				if(os){
				document.getElementById("divv").innerHTML += '<iframe id="os" style="width:70%;height:70%;margin-left:200px;margin-top:120px;" src="/os/os.html"></iframe>';
				os = false;
				}
			},
            'işletim sistemini kapat' : function(){
				if(os == false){
              var osw = document.getElementById("os");
			  osw.parentNode.removeChild(osw);
			  os = true;
				}
            }
          };
        
          annyang.addCallback('result',function(whatWasHeard) { document.getElementById("cmds").innerHTML += " || " + whatWasHeard[0]; });

          // Add our commands to annyang
          annyang.addCommands(commands);
        
          // Start listenaing. You can call this here, or attach this call to an event, button, etc.
          annyang.start();
        }
    </script>
</body>
</html>
